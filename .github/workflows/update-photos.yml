name: Update Photo Links

on:
  workflow_dispatch:
    inputs:
      photo1:
        description: 'Ð¡ÑÑ‹Ð»ÐºÐ° Ð½Ð° Ð¿ÐµÑ€Ð²Ð¾Ðµ Ñ„Ð¾Ñ‚Ð¾'
        required: true
        default: ''
      photo2:
        description: 'Ð¡ÑÑ‹Ð»ÐºÐ° Ð½Ð° Ð²Ñ‚Ð¾Ñ€Ð¾Ðµ Ñ„Ð¾Ñ‚Ð¾'
        required: true
        default: ''
      description1:
        description: 'ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ð¿ÐµÑ€Ð²Ð¾Ð³Ð¾ Ñ„Ð¾Ñ‚Ð¾'
        required: false
        default: 'Ð¤Ð¾Ñ‚Ð¾ 1'
      description2:
        description: 'ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ð²Ñ‚Ð¾Ñ€Ð¾Ð³Ð¾ Ñ„Ð¾Ñ‚Ð¾'
        required: false
        default: 'Ð¤Ð¾Ñ‚Ð¾ 2'

jobs:
  update-photos:
    runs-on: ubuntu-latest
    permissions:
      contents: write  # ÐšÐ»ÑŽÑ‡ÐµÐ²Ð¾Ðµ Ñ€Ð°Ð·Ñ€ÐµÑˆÐµÐ½Ð¸Ðµ!
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      with:
        fetch-depth: 0  # ÐŸÐ¾Ð»Ð½Ð°Ñ Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ñ ÐºÐ¾Ð¼Ð¼Ð¸Ñ‚Ð¾Ð²
    
    - name: Setup Git
      run: |
        git config --global user.name "github-actions[bot]"
        git config --global user.email "github-actions[bot]@users.noreply.github.com"
    
    - name: Create or update photos file
      run: |
        # Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ð¸ÑŽ ÐµÑÐ»Ð¸ Ð½ÐµÑ‚
        mkdir -p docs
        
        # Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ñ„Ð°Ð¹Ð» Ñ Ñ„Ð¾Ñ‚Ð¾
        cat > docs/PHOTOS.md << EOF
        # ðŸ“¸ Ð¡ÑÑ‹Ð»ÐºÐ¸ Ð½Ð° Ñ„Ð¾Ñ‚Ð¾Ð³Ñ€Ð°Ñ„Ð¸Ð¸
        
        ## ðŸ“ Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ
        - **Ð”Ð°Ñ‚Ð° Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ:** $(date '+%Y-%m-%d %H:%M:%S')
        - **ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¾ Ñ‡ÐµÑ€ÐµÐ·:** GitHub Actions Workflow
        
        ## ðŸ–¼ï¸ Ð¤Ð¾Ñ‚Ð¾Ð³Ñ€Ð°Ñ„Ð¸Ð¸
        
        ### ${{ github.event.inputs.description1 }}
        ![${{ github.event.inputs.description1 }}](${{ github.event.inputs.photo1 }})
        
        **Ð¡ÑÑ‹Ð»ÐºÐ°:** [${{ github.event.inputs.photo1 }}](${{ github.event.inputs.photo1 }})
        
        ---
        
        ### ${{ github.event.inputs.description2 }}
        ![${{ github.event.inputs.description2 }}](${{ github.event.inputs.photo2 }})
        
        **Ð¡ÑÑ‹Ð»ÐºÐ°:** [${{ github.event.inputs.photo2 }}](${{ github.event.inputs.photo2 }})
        
        ---
        
        ## ðŸ“Š Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ð¹
        \`\`\`bash
        ÐŸÐ¾ÑÐ»ÐµÐ´Ð½ÐµÐµ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ: $(date)
        Ð’ÑÐµÐ³Ð¾ Ñ„Ð¾Ñ‚Ð¾Ð³Ñ€Ð°Ñ„Ð¸Ð¹: 2
        \`\`\`
        EOF
        
        echo "Ð¤Ð°Ð¹Ð» docs/PHOTOS.md ÑÐ¾Ð·Ð´Ð°Ð½/Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½"
        cat docs/PHOTOS.md
    
    - name: Commit and push changes
      run: |
        # ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ ÐµÑÑ‚ÑŒ Ð»Ð¸ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ
        if git diff --quiet && git diff --cached --quiet; then
          echo "ÐÐµÑ‚ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹ Ð´Ð»Ñ ÐºÐ¾Ð¼Ð¼Ð¸Ñ‚Ð°"
          exit 0
        fi
        
        # Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ
        git add docs/PHOTOS.md
        
        # Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ ÐºÐ¾Ð¼Ð¼Ð¸Ñ‚
        git commit -m "ðŸ“¸ ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ñ„Ð¾Ñ‚Ð¾ ÑÑÑ‹Ð»Ð¾Ðº
        
        Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ñ‹/Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ñ‹:
        - ${{ github.event.inputs.description1 }}
        - ${{ github.event.inputs.description2 }}
        
        Ð”Ð°Ñ‚Ð°: $(date '+%Y-%m-%d %H:%M:%S')
        Workflow: ${{ github.workflow }}"
        
        # ÐŸÑƒÑˆÐ¸Ð¼ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ
        git push origin HEAD:${{ github.ref }}
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
